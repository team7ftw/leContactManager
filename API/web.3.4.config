<configuration>
    <appSettings>
        ...
    </appSettings>
    <!-- The system.web and system.webServer tags are required to access routes in the Fask app (besides the root).
            Adapted from https://github.com/Azure-Samples/python-docs-hello-world/issues/4 -->
    <system.web>
        <compilation debug="true" targetFramework="4.0" />
    </system.web>
    <system.webServer>
        <modules runAllManagedModulesForAllRequests="true" />
        <handlers>
            <remove name="Python27_via_FastCGI" />
            <remove name="Python34_via_FastCGI" />
            <add name="Python FastCGI"
                                   path="handler.fcgi"
                                   verb="*"
                                   modules="FastCgiModule"
                                   scriptProcessor="D:\Python34\python.exe|D:\Python34\Scripts\wfastcgi.py"
                                   resourceType="Unspecified"
                                   requireAccess="Script" />
        </handlers>
        <rewrite>
            <rules>
                <rule name="Static Files" stopProcessing="true">
                    <conditions>
                        <add input="true" pattern="false" />
                    </conditions>
                </rule>
                <rule name="Configure Python" stopProcessing="true">
                    <match url="(.*)" ignoreCase="false" />
                    <conditions>
                        <add input="{REQUEST_URI}" pattern="^/static/.*" ignoreCase="true" negate="true" />
                    </conditions>
                    <action type="Rewrite" url="handler.fcgi/{R:1}" appendQueryString="true" />
                </rule>
            </rules>
        </rewrite>
    </system.webServer>
</configuration>
